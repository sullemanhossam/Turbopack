{"version":3,"file":"index.js","sources":["../src/goto-line.js"],"sourcesContent":["import { panels, getPanel, showPanel } from \"@codemirror/next/panel\";\nimport { EditorSelection } from \"@codemirror/next/state\";\nimport { EditorView, themeClass } from \"@codemirror/next/view\";\nfunction createLineDialog(view) {\n    let dom = document.createElement(\"form\");\n    dom.innerHTML = `<label>${view.state.phrase(\"Go to line:\")} <input class=${themeClass(\"textfield\")} name=line></label>\n<button class=${themeClass(\"button\")} type=submit>${view.state.phrase(\"go\")}</button>`;\n    let input = dom.querySelector(\"input\");\n    function go() {\n        let n = parseInt(input.value, 10);\n        view.dispatch({\n            reconfigure: { append: [baseTheme] },\n            selection: !isNaN(n) && n > 0 && n <= view.state.doc.lines ? EditorSelection.cursor(view.state.doc.line(n).from) : undefined\n        });\n        view.focus();\n    }\n    dom.addEventListener(\"keydown\", event => {\n        if (event.keyCode == 27) { // Escape\n            event.preventDefault();\n            view.dispatch({ reconfigure: { append: [baseTheme] } });\n            view.focus();\n        }\n        else if (event.keyCode == 13) { // Enter\n            event.preventDefault();\n            go();\n        }\n    });\n    dom.addEventListener(\"submit\", go);\n    return { dom, style: \"gotoLine\", pos: -10 };\n}\n/// Command that shows a dialog asking the user for a line number, and\n/// when a valid number is provided, moves the cursor to that line.\n///\n/// The dialog can be styled with the `panel.gotoLine` theme\n/// selector.\nexport const gotoLine = view => {\n    let panel = getPanel(view, createLineDialog);\n    if (!panel) {\n        view.dispatch({ reconfigure: { append: [panels(), showPanel.of(createLineDialog), baseTheme] } });\n        panel = getPanel(view, createLineDialog);\n    }\n    if (panel)\n        panel.dom.querySelector(\"input\").focus();\n    return true;\n};\nconst baseTheme = EditorView.baseTheme({\n    \"panel.gotoLine\": {\n        padding: \"2px 6px 4px\",\n        \"& label\": { fontSize: \"80%\" }\n    }\n});\n/// Keymap that binds Alt-g to [`gotoLine`](#goto-line.gotoLine).\nexport const gotoLineKeymap = [\n    { key: \"Alt-g\", run: gotoLine }\n];\n"],"names":[],"mappings":"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"}